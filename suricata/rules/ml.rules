# ================== ML.RULES - DETECCIÓN DE ESCANEOS ==================

# Detección de Escaneo TCP SYN
alert tcp any any -> any any (msg:"POSIBLE ESCANEO DE PUERTOS - TCP SYN"; flags:S; threshold:type both, track by_src, count 5, seconds 60; sid:2000001; rev:1;)

# Detección de Escaneo TCP CONNECT
alert tcp any any -> any any (msg:"POSIBLE ESCANEO DE PUERTOS - TCP CONNECT"; flags:S,12; threshold:type both, track by_src, count 5, seconds 60; sid:2000002; rev:1;)

# Detección de Escaneo UDP
alert udp any any -> any any (msg:"POSIBLE ESCANEO DE PUERTOS - UDP"; threshold:type both, track by_src, count 5, seconds 60; sid:2000003; rev:1;)

# Detección de Escaneo ICMP (Ping Sweep)
alert icmp any any -> any any (msg:"POSIBLE ESCANEO DE RED - ICMP PING SWEEP"; itype:8; threshold:type both, track by_src, count 5, seconds 60; sid:2000004; rev:1;)

alert http any any -> any any (msg:"Acceso a Facebook detectado"; flow:to_server; http.host; content:"facebook.com"; nocase; sid:1000001; rev:1;)
alert http any any -> any any (msg:"Acceso a Facebook detectado"; flow:to_server; http.host; content:"https://facebook.com"; nocase; sid:1000002; rev:42;)
alert http any any -> any any (msg:"Tráfico HTTP detectado"; flow:to_server; sid:1000002; rev:41;)
